# Intellimark Weekly Sales Quantity Forecasting

## Project Overview

This project aims to develop a robust forecasting model to predict total weekly sales quantity for Intellimark. The primary objective was to achieve a **monthly accuracy of over 80%** for a validation period (June, July, and August 2024) and subsequently generate a reliable forecast for the next three months (September, October, and November 2024).

The final solution is a hybrid time series model that combines the strengths of SARIMA and Prophet, achieving an **average monthly accuracy of 83.2%** on the validation set.

---

## Repository Structure

This repository contains the dataset, analysis notebooks, and final outputs:
├── Task_File.csv # Raw input data provided for the task
├── cleaned_weekly_data.csv # Intermediate cleaned data file generated by the EDA
├── Forecasting_EDA.ipynb # Jupyter Notebook for data cleaning, EDA, and visualization
├── Forecasting_modeling.ipynb # Jupyter Notebook for feature engineering, model training, validation, and forecasting
├── weekly_quantity_forecast.xlsx # Final deliverable: an Excel file with the weekly forecasts for Sep-Nov 2024
├── sarima_model.pkl # Saved SARIMA model object
├── prophet_model.pkl # Saved Prophet model object
└── README.md # This file

---

## Methodology

The project was executed in two main phases: Exploratory Data Analysis and Forecasting & Modeling.

### 1. Exploratory Data Analysis (EDA) & Data Cleaning

The initial analysis was performed in the `Forecasting_EDA.ipynb` notebook. The key steps were:

- **Data Loading & Inspection:** The raw `Task_File.csv` was loaded and inspected for data types, missing values, and inconsistencies.
- **Date Handling:** The `weekend_date` column contained mixed date formats, which were parsed and standardized into a consistent datetime object.
- **Aggregation:** To create a univariate time series, the data was grouped by the weekly `date`, and the `quantity` was summed up. This produced a clean, weekly sales dataset.
- **Key Insight - Seasonality:** Time series plots, decomposition plots, and Autocorrelation (ACF) plots all revealed a strong **yearly seasonality** with a 52-week cycle. This was the most critical finding from the EDA and heavily influenced the modeling strategy.
- **Categorical Analysis:** Sales contributions from different `channels`, `brands`, and `categories` were visualized to understand the main business drivers.

### 2. Forecasting & Modeling

The modeling process, detailed in `Forecasting_modeling.ipynb`, involved several stages:

- **Data Preparation:** The `cleaned_weekly_data.csv` was split into a training set (data up to May 31, 2024) and a validation set (June, July, August 2024).

- **Feature Engineering:** For machine learning models, the following features were created from the time series:
    - **Lag Features:** Past values of `quantity` (up to 7 weeks back).
    - **Rolling Statistics:** Rolling means and medians over 4 and 8-week windows.
    - **Time-based Features:** `year` and `month` to help models capture time-dependent patterns.

- **Model Selection & Training:** A range of models were trained and evaluated:
    1.  **Machine Learning Models:** Random Forest, Gradient Boosting, XGBoost.
    2.  **Time Series Models:**
        - **SARIMA:** Tuned with a `seasonal_order` of `(1, 1, 1, 52)` to capture the yearly seasonality identified in the EDA.
        - **Prophet:** Tuned by enabling its built-in `yearly_seasonality`.
    3.  **Ensemble Model:** A final model was created by taking a **50/50 weighted average** of the predictions from the fine-tuned SARIMA and Prophet models. This hybrid approach proved to be the most accurate.

- **Model Validation:** The models were validated against the actual sales data for June, July, and August 2024 using the specified Monthly Accuracy metric.

- **Final Forecast:** The best-performing models (SARIMA and Prophet) were retrained on the *entire* dataset (including the validation period) to ensure the forecast for Sep-Nov 2024 was as up-to-date as possible. The final forecast was generated using the combined SARIMA-Prophet model.

---

## Key Findings & Results

-   **Achieved Accuracy:** The final `Combined_tuned` ensemble model achieved an **average monthly accuracy of 83.2%**, surpassing the 80% target.
    -   June 2024 Accuracy: **81.0%**
    -   July 2024 Accuracy: **83.6%**
    -   August 2024 Accuracy: **85.0%**
-   **Forecast:** The weekly forecasts for September, October, and November 2024 are provided in `weekly_quantity_forecast.xlsx`.
-   **Reproducibility:** The final, retrained SARIMA and Prophet models are saved as `.pkl` files, allowing for easy regeneration of the forecast without needing to retrain.

---

## How to Run This Project

### 1. Prerequisites
This project was developed in Python. You will need to have the following libraries installed:
```bash
pip install pandas numpy matplotlib seaborn scikit-learn xgboost statsmodels prophet joblib openpyxl
```
### 2. Execution Order
To replicate the results, run the notebooks in the following order:
  #### Step 1: Run the EDA Notebook
    -  **Notebook:** Forecasting_EDA.ipynb
    -  **Input:** Requires the raw Task_File.csv to be in the same directory.
    -  **Action:** This notebook cleans the raw data, handles date inconsistencies, performs exploratory analysis, and aggregates the data into a weekly time series.
    -  **Output:** Generates the cleaned_weekly_data.csv file, which is the necessary input for the modeling notebook.
  #### Step 2: Run the Modeling Notebook
    -  **Notebook:** Forecasting_modeling.ipynb
    -  **Input:** Requires the cleaned_weekly_data.csv file generated from Step 1.
    -  **Action:** This notebook builds, trains, and validates multiple forecasting models. It then uses the best model to generate a forecast for the next three months.
    -  **Outputs:**
        -  **Validation Plots & Tables:** Visualizations and accuracy metrics for the June-August 2024 validation period.
        -  **Final Forecast Plot:** A chart showing historical data alongside the September-November 2024 forecast.
        -  **Saved Model Files:** sarima_model.pkl and prophet_model.pkl (the final, retrained models).
        -  **Final Forecast File:** weekly_quantity_forecast.xlsx containing the weekly predicted quantities.
### Future Improvements & Next Steps

While the current model meets the 80% accuracy target, its performance can be further enhanced with the following steps:

1.  **Leverage Categorical Features as External Regressors:**
    -   Instead of aggregating all data, the `brand`, `channel`, and `category` features can be incorporated into SARIMAX and Prophet models. This could capture more granular sales drivers and improve forecast accuracy.

2.  **Optimize Ensemble Weighting:**
    -   The current hybrid model uses a simple 50/50 average. Experimenting with different weighting strategies (e.g., 60/40) based on which model performs better during specific seasons could yield a more precise forecast.

3.  **Systematic Hyperparameter Tuning:**
    -   Conduct a more exhaustive grid search on the SARIMA parameters (`p,d,q`,`P,D,Q`) and machine learning models to find the absolute optimal configuration for this specific dataset.

4.  **Anomaly Detection and Handling:**
    -   The EDA decomposition plot showed some residuals (unexplained variance). Investigating these spikes could reveal the impact of holidays, promotions, or other external events that could be explicitly modeled in the future.
